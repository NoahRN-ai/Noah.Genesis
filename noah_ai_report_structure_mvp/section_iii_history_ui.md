# AI Report - Section III: Patient History & Context (UI Blueprint)

This document outlines the conceptual UI structure for Section III of the AI-generated shift report.
It shows where data generated by `populate_section_iii_patient_history(patient_id)` would be displayed and includes placeholders for editable fields.

```html
<!-- Conceptual HTML-like structure for a single patient -->
<div class="section-iii-patient-history">
  <div class="header">
    <h4>Section III: Patient History & Context</h4>
  </div>

  <div class="history-grid">
    <div class="history-item full-width">
      <strong>Relevant Past Medical History (from RAG):</strong>
      <p id="relevant-pmh">{{ relevant_past_medical_history }}</p>
      <!-- RAG data is typically display-only in this context, updated by automated processes -->
    </div>

    <div class="history-item full-width">
      <strong>Significant Surgical History (from RAG):</strong>
      <p id="significant-psh">{{ significant_surgical_history }}</p>
      <!-- RAG data is typically display-only -->
    </div>

    <div class="history-item full-width">
      <strong>Social History Highlights (from RAG/Profile):</strong>
      <p id="social-history">{{ social_history_highlights }}</p>
      <!-- May be partially editable if linked to a profile field -->
    </div>

    <div class="history-item editable full-width">
      <strong>About Me (Patient Preferences, What Matters):</strong>
      <div id="about-me-display" class="display-content">
        <p>{{ about_me }}</p> <!-- Populated by: about_me -->
      </div>
      <div id="about-me-edit" class="edit-content" style="display:none;">
        <textarea id="about-me-input" rows="4">{{ about_me }}</textarea>
        <button onclick="saveAboutMe('{{ patient_id }}')">Save About Me</button>
        <button onclick="cancelEdit('about-me')">Cancel</button>
      </div>
      <button onclick="toggleEdit('about-me')" id="about-me-edit-button">Edit About Me</button>
    </div>

    <div class="history-item editable full-width">
      <strong>Our Goals (Patient/Family Stated Goals for this Admission):</strong>
      <div id="our-goals-display" class="display-content">
        <p>{{ our_goals }}</p> <!-- Populated by: our_goals -->
      </div>
      <div id="our-goals-edit" class="edit-content" style="display:none;">
        <textarea id="our-goals-input" rows="4">{{ our_goals }}</textarea>
        <button onclick="saveOurGoals('{{ patient_id }}')">Save Our Goals</button>
        <button onclick="cancelEdit('our-goals')">Cancel</button>
      </div>
      <button onclick="toggleEdit('our-goals')" id="our-goals-edit-button">Edit Our Goals</button>
    </div>
  </div>
</div>

<!--
Data Mapping (for a given patient_id):
- relevant_past_medical_history -> {{ relevant_past_medical_history }}
- significant_surgical_history -> {{ significant_surgical_history }}
- social_history_highlights -> {{ social_history_highlights }}
- about_me -> {{ about_me }} (both display and textarea input)
- our_goals -> {{ our_goals }} (both display and textarea input)

JavaScript functions (conceptual):
- toggleEdit(sectionId): Shows the textarea and Save/Cancel buttons, hides the display paragraph and Edit button.
- cancelEdit(sectionId): Hides edit UI, shows display UI.
- saveAboutMe(patientId):
    - Takes content from 'about-me-input'.
    - Calls a backend function (simulated by `save_to_firestore(patientId, 'about_me', new_content)`).
    - On success, updates the 'about-me-display' paragraph and toggles back to display mode.
- saveOurGoals(patientId): Similar to saveAboutMe for 'our_goals'.

This section is highly interactive, allowing nurses to contribute to a shared understanding of the patient's personal context and care goals.
The `patient_id` would need to be passed to the JavaScript functions, possibly by rendering it into the HTML or as a data attribute.
-->
```
