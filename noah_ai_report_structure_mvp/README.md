# Noah AI Report Structure (MVP) - Sections I, II, III

This directory contains the MVP definition for the data structures and mock data generation logic for the first three sections of the AI-Powered Shift Report. It also includes conceptual UI blueprints for how this information might be displayed.

## File Index

1.  **`report_data_generator.py`**
    *   **Purpose:** This Python script is responsible for generating mock data that would populate Sections I, II, and III of the AI shift report.
    *   **Functionality:**
        *   **Integrated Mock Data Access:**
            *   `get_mock_patient_profile(patient_id)`: Now attempts to fetch core patient profile data by importing and using mock data (`PSA_MOCK_PATIENT_PROFILES`) from `noah_patient_summary_agent_mvp/patient_summary_agent.py`. It augments this with additional details needed for Section II if they aren't present. Includes a local fallback if the import fails.
            *   `get_mock_firestore_data(patient_id, data_key)`: Continues to simulate fetching specific text-based data like "About Me" or "Our Goals" from a local mock store, as this is specific to the report structure.
        *   **Integrated RAG for Patient History:**
            *   `fetch_patient_history_summary_from_rag(patient_id)`: Modified to simulate a more integrated call. It attempts to use imported functions (`psa_query_vertex_ai_search`, `psa_generate_summary_with_llm`) and data sources (`PSA_MOCK_PATIENT_PROFILES`, `PSA_MOCK_CLINICAL_KB`) from `noah_patient_summary_agent_mvp/patient_summary_agent.py` to generate a history-focused summary. This provides a more realistic simulation of how a dedicated summary agent might provide this information. Includes a local fallback.
        *   **Section Data Population:**
            *   `populate_section_i_system_overview()`: (No change in this step) Generates data for unit-wide information.
            *   `populate_section_ii_patient_identification(patient_id)`: (No change in its direct logic, but `get_mock_patient_profile` it calls is updated).
            *   `populate_section_iii_patient_history(patient_id)`: (No change in its direct logic, but `fetch_patient_history_summary_from_rag` it calls is updated).
            *   `populate_section_v_systems_assessment(patient_id)`: (No change in this step) Main function for Section V, calling sub-functions for each physiological system.
        *   **Input Handling Placeholder:**
            *   `save_to_firestore(patient_id, data_key, content)`: Simulates saving user-inputted content (e.g., for "About Me") back to Firestore. It currently prints the data that would be saved and updates the in-memory mock store for demonstration.
    *   **Usage:** The `if __name__ == "__main__":` block demonstrates how to call these functions to generate data for mock patients, including the new Section V, and simulate saving user input.

2.  **`section_i_overview_ui.md`**
    *   **Purpose:** A markdown file outlining a conceptual HTML-like structure for displaying Section I (System & Unit Overview) data.
    *   **Content:** Shows where data elements generated by `populate_section_i_system_overview()` (e.g., `current_date_time`, `shift_info`, `unit_census_overview`) would be placed in a UI.

3.  **`section_ii_identification_ui.md`**
    *   **Purpose:** A markdown file outlining a conceptual HTML-like structure for Section II (Patient Identification).
    *   **Content:** Illustrates how patient-specific data from `populate_section_ii_patient_identification()` (e.g., `room_no`, `patient_name_dob_mrn`, `allergies`) would be displayed, typically within a patient card or profile view.

4.  **`section_iii_history_ui.md`**
    *   **Purpose:** A markdown file outlining a conceptual HTML-like structure for Section III (Patient History & Context).
    *   **Content:** Shows the layout for displaying data from `populate_section_iii_patient_history()` (e.g., `relevant_past_medical_history`, `about_me`). Importantly, it also includes conceptual UI elements for editing fields like "About Me" and "Our Goals", suggesting how users might interact with these components.

5.  **`section_v_systems_assessment_ui.md`**
    *   **Purpose:** A markdown file outlining a conceptual HTML-like structure for Section V (Core Systems Assessment).
    *   **Content:** This extensive file provides UI blueprints for each physiological system (Neurological, Pulmonary, Cardiovascular, GI, GU, Skin/Mobility, IV Access, Fluids/Infusions, Pain, Laboratory/Diagnostics). For each sub-system, it details:
        *   Where data from the corresponding `populate_..._assessment()` function in `report_data_generator.py` would be displayed (using `{{ placeholder }}` syntax).
        *   A distinction between fields intended for display of mock/manual data (e.g., `<span class="data-display">{{ ... }}</span>`) and fields that would serve as simple manual input areas in an MVP (e.g., `<input type="text" value="{{ ... }}">`, `<textarea>{{ ... }}</textarea>`).
        *   Notes on conceptual placeholders for richer UI elements (e.g., "Interactive Digital Body Map" for skin assessment).

## How the System Works (Conceptually)

1.  The `report_data_generator.py` script acts as a backend data provider for the UI.
2.  It fetches and consolidates data from various (simulated) sources:
    *   Patient profiles (mock Firestore).
    *   Specific patient narratives like "About Me" (mock Firestore).
    *   Summarized history (mock RAG system).
3.  This data is then structured according to the needs of each report section (I, II, III).
4.  The `.md` files serve as blueprints for front-end developers, showing how this structured data should be presented to the user and where user inputs can be incorporated.
5.  User inputs (e.g., updating "Our Goals") are conceptually sent back to a service that would use functions like `save_to_firestore` to persist the changes.

## Important Notes

*   **Simulations:**
    *   **Data Sources:** All data fetching (Firestore, RAG) is simulated using hardcoded Python dictionaries or simple functions. No actual database or AI services are called.
    *   **Data Storage:** The `save_to_firestore` function only prints data and updates an in-memory mock store. It does not interact with a real Firestore database.
*   **UI Blueprints:** The `.md` files are **not** functional UI code. They are HTML-like outlines intended to guide UI development. They use `{{ placeholder }}` syntax to indicate where dynamic data would be injected.
*   **MVP Focus:** This MVP focuses on defining the data flow and structure for these initial report sections. Further development would involve building actual UI components and integrating with real backend services.
