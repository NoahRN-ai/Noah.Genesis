# Noah AI Report - Section VI: Shift Events Log Display (MVP)

This directory contains the MVP definition for the data preparation logic and UI outline for displaying Section VI (Shift Events Log) of the AI-Powered Shift Report. This section focuses on presenting a chronological list of patient-related events from the shift, with basic filtering capabilities.

## File Index

1.  **`events_log_data_prep.py`**
    *   **Purpose:** This Python script is responsible for generating and preparing mock event data that would populate the Shift Events Log.
    *   **Functionality:**
        *   **Mock Event Data Source (`MOCK_PATIENT_EVENTS`):** An in-memory dictionary containing lists of sample event data for mock patients. Each event includes fields like `timestamp`, `patient_id`, `event_type`, `source`, and event-specific `details` (e.g., vital sign readings, observation text, intervention descriptions).
        *   `get_mock_shift_events(patient_id: str, filter_criteria: dict = None) -> list`:
            *   Fetches mock events for a given `patient_id`.
            *   Simulates basic filtering based on the `filter_criteria` dictionary. Supported filters include:
                *   `event_type`: Filters events to a specific type (e.g., "vital_sign", "observation").
                *   `time_range`: Filters events within a specified start and/or end time (expects ISO datetime strings).
            *   Returns a list of event dictionaries, sorted by timestamp in descending order (newest first).
        *   `format_event_for_display(event_data: dict) -> str`:
            *   Takes a single event dictionary as input.
            *   Formats the event into a human-readable string summary suitable for display in a list. For example, "[08:00] Vital Sign: Heart Rate 72 bpm".
    *   **Example Usage:** The `if __name__ == "__main__":` block demonstrates calling `get_mock_shift_events()` with various filter criteria and using `format_event_for_display()` to show how the events would be presented.

2.  **`section_vi_events_log_ui.md`**
    *   **Purpose:** A markdown file outlining a conceptual HTML-like structure for displaying the Shift Events Log (Section VI) and its associated filtering controls.
    *   **Content:**
        *   **Filtering Controls:** UI mockups for:
            *   A dropdown menu to filter by `event_type`.
            *   Datetime input fields for selecting a `time_range` (start and end).
            *   "Apply Filters" and "Clear Filters" buttons.
        *   **Events Display Area:**
            *   An unordered list (`<ul>`) where formatted event strings (generated by `format_event_for_display()`) would be dynamically rendered.
            *   A message area to indicate when no events match the filters or if no events are available.
        *   **Conceptual JavaScript:** Includes comments outlining the JavaScript logic that would handle:
            *   Collecting filter values from the UI controls.
            *   Calling a backend function (simulated by `get_mock_shift_events()`) to fetch and filter data.
            *   Dynamically updating the events list in the UI based on the filtered results.

## How the System Works (Conceptually)

1.  The `events_log_data_prep.py` script simulates the backend logic for fetching and processing event data. In a real system, `get_mock_shift_events()` would query a database (like AlloyDB `EventLogs` table from Step 1) using the provided filters.
2.  The `section_vi_events_log_ui.md` file provides a blueprint for the front-end UI.
3.  When a user interacts with the filter controls on the UI:
    *   Conceptual JavaScript captures the selected filter values.
    *   It requests filtered event data from the backend (simulated by calling `get_mock_shift_events()` with the `filter_criteria`).
    *   The backend returns a list of filtered event dictionaries.
    *   The JavaScript then iterates through the returned events, calls `format_event_for_display()` for each, and updates the HTML list to display the formatted event strings.

## Important Notes

*   **Simulations:**
    *   **Data Source:** All event data is hardcoded within `MOCK_PATIENT_EVENTS` in the Python script. No actual database is queried.
    *   **Filtering Logic:** The filtering in `get_mock_shift_events()` is a basic Python implementation. In a real system, these filters would be translated into database queries for efficiency.
*   **UI Blueprint:** The `.md` file is **not** functional UI code. It's an HTML-like outline to guide UI development, using `{{ placeholder }}` syntax and conceptual JavaScript comments to illustrate dynamic behavior.
*   **Date/Time Handling:** The script uses `dateutil.parser` for robust parsing of ISO 8601 timestamp strings, which is important for accurate time-based filtering.
*   **MVP Focus:** This MVP defines the data structures, mock data pipeline, and UI concept for displaying and filtering shift events. Further development would involve actual UI implementation, API integration, and robust database querying.
